<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	
	<canvas id="canvas">
		你的浏览器不支持canvas,请更换后尝试,或者联系wo
	</canvas>
	<script type="text/javascript">

		//简单实现requestAnimFrame兼容性
		window.requestAnimFrame = (function(){
  		return  window.requestAnimationFrame       ||
          window.webkitRequestAnimationFrame ||
          window.mozRequestAnimationFrame    ||
          function( callback ){
            window.setTimeout(callback, 1000 / 60);
          };
		})();

	var can = document.getElementById("canvas");
	var ctx = can.getContext("2d");
	var balls = [];
	window.onload = init();
	function init(){
		can.width = 1200;
		can.height = 600;

		drawBalls();
		gameloop();
		//setInterval("gameloop()",16.7);

		




	}
	function gameloop(){
		window.requestAnimFrame(gameloop);

		
		drawBall();
		updateBalls();

	}

	function drawBalls(){
		

		for(var i = 0;i < 80;i++){
			
			var R = Math.floor(Math.random()*255);
			var G = Math.floor(Math.random()*255);
			var B = Math.floor(Math.random()*255);
			var radius = Math.random()*50 + 20;
			ball = {
				
			color:"rgb(" + R + "," + G + "," + B + ")",
			radius:radius,
			x:Math.random()*(can.width-2*radius) + radius,
			y:Math.random()*(can.height-2*radius) + radius,
			// vx: (Math.random()*5 + 1)*Math.pow(-1,Math.floor(Math.random()*1000)),
			// vy: (Math.random()*5 + 1)*Math.pow(-1,Math.floor(Math.random()*1000)),
			vx:Math.floor((Math.random()*5 + 1)),
			vy:Math.floor((Math.random()*5 + 1))
			};
			//balls.push(ball);
			balls[i]=ball;
			
		}
	}
	function drawBall(){
		ctx.clearRect(0,0,canvas.width,canvas.height);
		//ctx.globalAlpha = 1;
		ctx.globalCompositeOperation="xor";
		for(var i=0;i<balls.length;i++){
			ctx.fillStyle = balls[i].color;
			ctx.beginPath();
			ctx.arc(balls[i].x,balls[i].y,balls[i].radius,0,Math.PI*2);
			ctx.closePath();
			ctx.fill();
		}
	}
	function updateBalls(){
		for(var i = 0;i < balls.length;i++){
			balls[i].x += balls[i].vx;
			balls[i].y += balls[i].vy;
			if(balls[i].x - balls[i].radius <=0){
				balls[i].vx = -balls[i].vx;
				balls[i].x = balls[i].radius;
			}
			if(balls[i].x > can.width-balls[i].radius){
				balls[i].vx = -balls[i].vx;
				balls[i].x = can.width-balls[i].radius;
			}
			if(balls[i].y - balls[i].radius <=0){
				balls[i].vy = -balls[i].vy;
				balls[i].y = balls[i].radius;
			}
			if(balls[i].y > can.height - balls[i].radius){
				balls[i].vy = -balls[i].vy;
				balls[i].y = can.height - balls[i].radius;
			}

		

		}
		

	}

	</script>
</body>
</html>